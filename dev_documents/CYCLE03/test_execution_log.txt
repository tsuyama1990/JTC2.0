============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
testpaths: tests
plugins: cov-7.0.0, langsmith-0.7.6, anyio-4.12.1
collected 19 items / 15 errors

==================================== ERRORS ====================================
_____________ ERROR collecting tests/integration/test_rag_flow.py ______________
tests/integration/test_rag_flow.py:10: in <module>
    from src.agents.cpo import CPOAgent
src/agents/cpo.py:5: in <module>
    from src.agents.base import SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
________________ ERROR collecting tests/uat/test_uat_cycle01.py ________________
tests/uat/test_uat_cycle01.py:10: in <module>
    from src.core.graph import create_app
src/core/graph.py:7: in <module>
    from src.core.factory import AgentFactory
src/core/factory.py:3: in <module>
    from src.agents.cpo import CPOAgent
src/agents/cpo.py:5: in <module>
    from src.agents.base import SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
________________ ERROR collecting tests/uat/test_uat_cycle02.py ________________
tests/uat/test_uat_cycle02.py:4: in <module>
    from src.domain_models.simulation import DialogueMessage, Role
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
________________ ERROR collecting tests/uat/test_uat_cycle03.py ________________
tests/uat/test_uat_cycle03.py:8: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
___________ ERROR collecting tests/unit/domain_models/test_models.py ___________
tests/unit/domain_models/test_models.py:5: in <module>
    from src.domain_models.metrics import AARRR, DetailedMetrics, Metrics
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
_____ ERROR collecting tests/unit/domain_models/test_simulation_models.py ______
tests/unit/domain_models/test_simulation_models.py:5: in <module>
    from src.domain_models.simulation import DialogueMessage, Role
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
_________ ERROR collecting tests/unit/domain_models/test_transcript.py _________
tests/unit/domain_models/test_transcript.py:5: in <module>
    from src.domain_models.transcript import Transcript
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
________________ ERROR collecting tests/unit/test_cli_input.py _________________
tests/unit/test_cli_input.py:3: in <module>
    from main import safe_input
main.py:14: in <module>
    from src.core.graph import create_app
src/core/graph.py:7: in <module>
    from src.core.factory import AgentFactory
src/core/factory.py:3: in <module>
    from src.agents.cpo import CPOAgent
src/agents/cpo.py:5: in <module>
    from src.agents.base import SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
_____________ ERROR collecting tests/unit/test_cli_scalability.py ______________
tests/unit/test_cli_scalability.py:4: in <module>
    from main import browse_and_select
main.py:14: in <module>
    from src.core.graph import create_app
src/core/graph.py:7: in <module>
    from src.core.factory import AgentFactory
src/core/factory.py:3: in <module>
    from src.agents.cpo import CPOAgent
src/agents/cpo.py:5: in <module>
    from src.agents.base import SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
________________ ERROR collecting tests/unit/test_cpo_agent.py _________________
tests/unit/test_cpo_agent.py:3: in <module>
    from src.agents.cpo import CPOAgent
src/agents/cpo.py:5: in <module>
    from src.agents.base import SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
______________ ERROR collecting tests/unit/test_domain_models.py _______________
tests/unit/test_domain_models.py:5: in <module>
    from src.domain_models.persona import EmpathyMap, Persona
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
______________ ERROR collecting tests/unit/test_ideator_agent.py _______________
tests/unit/test_ideator_agent.py:5: in <module>
    from src.agents.ideator import IdeatorAgent
src/agents/ideator.py:8: in <module>
    from src.agents.base import BaseAgent, SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
______________ ERROR collecting tests/unit/test_memory_safety.py _______________
tests/unit/test_memory_safety.py:4: in <module>
    from main import browse_and_select
main.py:14: in <module>
    from src.core.graph import create_app
src/core/graph.py:7: in <module>
    from src.core.factory import AgentFactory
src/core/factory.py:3: in <module>
    from src.agents.cpo import CPOAgent
src/agents/cpo.py:5: in <module>
    from src.agents.base import SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
_____________ ERROR collecting tests/unit/test_simulation_logic.py _____________
tests/unit/test_simulation_logic.py:6: in <module>
    from src.agents.personas import FinanceAgent, NewEmployeeAgent
src/agents/personas.py:8: in <module>
    from src.agents.base import BaseAgent, SearchTool
src/agents/base.py:4: in <module>
    from src.domain_models.state import GlobalState
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
____________________ ERROR collecting tests/unit/test_ui.py ____________________
tests/unit/test_ui.py:5: in <module>
    from src.domain_models.simulation import DialogueMessage, Role
src/domain_models/__init__.py:2: in <module>
    from .state import GlobalState, Phase
src/domain_models/state.py:10: in <module>
    from .metrics import Metrics
src/domain_models/metrics.py:9: in <module>
    class AARRR(BaseModel):
src/domain_models/metrics.py:14: in AARRR
    ge=get_settings().validation.min_metric_value,
       ^^^^^^^^^^^^^^
src/core/config.py:285: in get_settings
    return Settings()
           ^^^^^^^^^^
.venv/lib/python3.12/site-packages/pydantic_settings/main.py:242: in __init__
    super().__init__(**__pydantic_self__.__class__._settings_build_values(sources, init_kwargs))
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Settings
E     Value error, OPENAI_API_KEY is missing [type=value_error, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.12/v/value_error
=========================== short test summary info ============================
ERROR tests/integration/test_rag_flow.py - pydantic_core._pydantic_core.Valid...
ERROR tests/uat/test_uat_cycle01.py - pydantic_core._pydantic_core.Validation...
ERROR tests/uat/test_uat_cycle02.py - pydantic_core._pydantic_core.Validation...
ERROR tests/uat/test_uat_cycle03.py - pydantic_core._pydantic_core.Validation...
ERROR tests/unit/domain_models/test_models.py - pydantic_core._pydantic_core....
ERROR tests/unit/domain_models/test_simulation_models.py - pydantic_core._pyd...
ERROR tests/unit/domain_models/test_transcript.py - pydantic_core._pydantic_c...
ERROR tests/unit/test_cli_input.py - pydantic_core._pydantic_core.ValidationE...
ERROR tests/unit/test_cli_scalability.py - pydantic_core._pydantic_core.Valid...
ERROR tests/unit/test_cpo_agent.py - pydantic_core._pydantic_core.ValidationE...
ERROR tests/unit/test_domain_models.py - pydantic_core._pydantic_core.Validat...
ERROR tests/unit/test_ideator_agent.py - pydantic_core._pydantic_core.Validat...
ERROR tests/unit/test_memory_safety.py - pydantic_core._pydantic_core.Validat...
ERROR tests/unit/test_simulation_logic.py - pydantic_core._pydantic_core.Vali...
ERROR tests/unit/test_ui.py - pydantic_core._pydantic_core.ValidationError: 1...
!!!!!!!!!!!!!!!!!!! Interrupted: 15 errors during collection !!!!!!!!!!!!!!!!!!!
============================== 15 errors in 8.35s ==============================
